{"version":3,"sources":["../../src/index.ts"],"names":[],"mappings":";;;;;AAAA,8EAA2E;AAC3E,wFAAmF;AACnF,uEAAoE;AAGpE,4EAA4E;AAC5E,iBAAiB;AACjB,4EAA4E;AAE5E;;GAEG;AACH,yBAAmC,EAAK,EAAE,OAAkC;IACxE,cAAc,CAAC,EAAE,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;IAClC,OAAO,EAAE,CAAC;AACd,CAAC;AAHD,0CAGC;AAED;;GAEG;AACH,4BAAmC,IAAY,EAAE,OAAkC;IAC/E,IAAM,EAAE,GAAG,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAC;IACtC,cAAc,CAAC,EAAE,EAAE,OAAO,IAAI,EAAE,CAAC,CAAC;IAClC,OAAO,EAAE,CAAC;AACd,CAAC;AAJD,gDAIC;AAED;;GAEG;AACH,wBAAwB,EAAO,EAAE,OAAiC;IAC9D,IAAM,QAAQ,GAAG,IAAI,mDAAwB,CAAC,EAAE,CAAC,CAAC;IAElD,mEAAmE;IACnE,IAAI,iBAA6B,CAAC;IAClC,IAAI,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,OAAO,CAAC,WAAW,CAAC,MAAM;QAC5D,iBAAiB,GAAI,OAAO,CAAC,WAAqB,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,YAAY,QAAQ,EAA9B,CAA8B,CAAC,CAAC;IACxG,IAAM,cAAc,GAAI,OAAO,CAAC,WAAqB,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,OAAO,UAAU,KAAK,QAAQ,EAA9B,CAA8B,CAAC,CAAC;IAC3G,iBAAiB,CAAC,IAAI,OAAtB,iBAAiB,EAAS,6DAA4B,CAAC,cAAc,CAAC,EAAE;IAE5E,IAAI,iBAA6B,CAAC;IAClC,IAAI,OAAO,IAAI,OAAO,CAAC,WAAW,IAAI,OAAO,CAAC,WAAW,CAAC,MAAM,EAAE;QAC9D,iBAAiB,GAAI,OAAO,CAAC,WAAqB,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,UAAU,YAAY,QAAQ,EAA9B,CAA8B,CAAC,CAAC;QACxG,IAAM,cAAc,GAAI,OAAO,CAAC,WAAqB,CAAC,MAAM,CAAC,UAAA,UAAU,IAAI,OAAA,OAAO,UAAU,KAAK,QAAQ,EAA9B,CAA8B,CAAC,CAAC;QAC3G,iBAAiB,CAAC,IAAI,OAAtB,iBAAiB,EAAS,6DAA4B,CAAC,cAAc,CAAC,EAAE;KAC3E;IAED,IAAI,OAAO,CAAC,mBAAmB,KAAK,SAAS,EAAE;QAC3C,QAAQ,CAAC,mBAAmB,GAAG,OAAO,CAAC,mBAAmB,CAAC;KAC9D;SAAM;QACH,QAAQ,CAAC,mBAAmB,GAAG,IAAI,CAAC;KACvC;IAED,QAAQ,CAAC,4BAA4B,GAAG,OAAO,CAAC,4BAA4B,CAAC;IAC7E,QAAQ,CAAC,4BAA4B,GAAG,OAAO,CAAC,4BAA4B,CAAC;IAE7E,sDAAsD;IACtD,QAAQ,CAAC,OAAO,CAAC,iBAAiB,EAAE,iBAAiB,CAAC,CAAC;AAC3D,CAAC;AAED,4EAA4E;AAC5E,0BAA0B;AAC1B,4EAA4E;AAE5E;;GAEG;AACH;IACI,IAAI,CAAE,MAAc,CAAC,oCAAoC;QACpD,MAAc,CAAC,oCAAoC,GAAG,IAAI,yCAAmB,EAAE,CAAC;IAErF,OAAQ,MAAc,CAAC,oCAAoC,CAAC;AAChE,CAAC;AALD,gEAKC;AAED,4EAA4E;AAC5E,wBAAwB;AACxB,4EAA4E;AAE5E,iCAA4B;AAC5B,kCAA6B","file":"index.js","sourcesContent":["import {MetadataArgsStorage} from \"./metadata-builder/MetadataArgsStorage\";\nimport {importClassesFromDirectories} from \"./util/DirectoryExportedClassesLoader\";\nimport {SocketControllerExecutor} from \"./SocketControllerExecutor\";\nimport {SocketControllersOptions} from \"./SocketControllersOptions\";\n\n// -------------------------------------------------------------------------\n// Main Functions\n// -------------------------------------------------------------------------\n\n/**\n * Registers all loaded actions in your express application.\n */\nexport function useSocketServer<T>(io: T, options?: SocketControllersOptions): T {\n    createExecutor(io, options || {});\n    return io;\n}\n\n/**\n * Registers all loaded actions in your express application.\n */\nexport function createSocketServer(port: number, options?: SocketControllersOptions): any {\n    const io = require(\"socket.io\")(port);\n    createExecutor(io, options || {});\n    return io;\n}\n\n/**\n * Registers all loaded actions in your express application.\n */\nfunction createExecutor(io: any, options: SocketControllersOptions): void {\n    const executor = new SocketControllerExecutor(io);\n\n    // second import all controllers and middlewares and error handlers\n    let controllerClasses: Function[];\n    if (options && options.controllers && options.controllers.length)\n        controllerClasses = (options.controllers as any[]).filter(controller => controller instanceof Function);\n        const controllerDirs = (options.controllers as any[]).filter(controller => typeof controller === \"string\");\n        controllerClasses.push(...importClassesFromDirectories(controllerDirs));\n\n    let middlewareClasses: Function[];\n    if (options && options.middlewares && options.middlewares.length) {\n        middlewareClasses = (options.middlewares as any[]).filter(controller => controller instanceof Function);\n        const middlewareDirs = (options.middlewares as any[]).filter(controller => typeof controller === \"string\");\n        middlewareClasses.push(...importClassesFromDirectories(middlewareDirs));\n    }\n\n    if (options.useClassTransformer !== undefined) {\n        executor.useClassTransformer = options.useClassTransformer;\n    } else {\n        executor.useClassTransformer = true;\n    }\n\n    executor.classToPlainTransformOptions = options.classToPlainTransformOptions;\n    executor.plainToClassTransformOptions = options.plainToClassTransformOptions;\n\n    // run socket controller register and other operations\n    executor.execute(controllerClasses, middlewareClasses);\n}\n\n// -------------------------------------------------------------------------\n// Global Metadata Storage\n// -------------------------------------------------------------------------\n\n/**\n * Gets the metadata arguments storage.\n */\nexport function defaultMetadataArgsStorage(): MetadataArgsStorage {\n    if (!(global as any).socketControllersMetadataArgsStorage)\n        (global as any).socketControllersMetadataArgsStorage = new MetadataArgsStorage();\n\n    return (global as any).socketControllersMetadataArgsStorage;\n}\n\n// -------------------------------------------------------------------------\n// Commonly Used exports\n// -------------------------------------------------------------------------\n\nexport * from \"./container\";\nexport * from \"./decorators\";\nexport * from \"./SocketControllersOptions\";\nexport * from \"./MiddlewareInterface\";\n"],"sourceRoot":"."}